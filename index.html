<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Beamer Presenter Tool</title>
  <meta name="description" content="Presenter view for Beamer PDF presentations with notes">

  <!-- Styles -->
  <link rel="stylesheet" href="styles/main.css">
  <link rel="stylesheet" href="styles/presenter.css">

  <!-- PDF.js -->
  <script src="vendor/pdfjs/pdf.min.mjs" type="module"></script>
  <script>
    // Make PDF.js available globally before modules load
    import('./vendor/pdfjs/pdf.min.mjs').then(pdfjsLib => {
      window.pdfjsLib = pdfjsLib;
    }).catch(() => {
      // Fallback: try loading as regular script
      console.log('Module import failed, trying script load...');
    });
  </script>
</head>

<body>
  <!-- Start Screen -->
  <div id="start-screen" class="start-screen">
    <div class="start-container">
      <header class="start-header animate-slide-up">
        <h1>Beamer Presenter Tool</h1>
        <p>Presenter view for Beamer PDF with notes</p>
      </header>

      <div class="start-card glass-panel animate-slide-up" style="animation-delay: 0.1s">
        <!-- File Drop Zone -->
        <div class="start-section">
          <div id="drop-zone" class="drop-zone">
            <div class="drop-zone-icon">ðŸ“„</div>
            <div class="drop-zone-text">
              <strong>Drop PDF here</strong><br>
              or click to browse
            </div>
            <input type="file" id="file-input" accept=".pdf">
          </div>
        </div>

        <!-- Divider -->
        <div class="divider">or</div>

        <!-- URL Input -->
        <div class="start-section">
          <div class="url-input-group">
            <input type="url" id="url-input" class="input" placeholder="Enter PDF URL...">
            <button id="url-load-btn" class="btn btn-primary">Load</button>
          </div>
          <p class="text-xs text-muted" style="margin-top: var(--spacing-xs)">
            Some URLs may fail due to CORS restrictions
          </p>
        </div>

        <!-- Settings -->
        <div class="start-section">
          <div class="settings-row">
            <label for="location-select">Notes Location</label>
            <select id="location-select" class="select">
              <option value="right" selected>Right (default)</option>
              <option value="left">Left</option>
              <option value="top">Top</option>
              <option value="bottom">Bottom</option>
            </select>
          </div>
        </div>

        <!-- Advanced Settings -->
        <div class="start-section">
          <div id="advanced-toggle" class="collapsible-header">
            <span class="icon">â–¶</span>
            <span>Advanced Settings</span>
          </div>
          <div id="advanced-content" class="collapsible-content">
            <div class="advanced-content">
              <div class="settings-row">
                <label for="split-input">Split Ratio</label>
                <input type="number" id="split-input" class="input" style="width: 80px" value="0.5" min="0.1" max="0.9"
                  step="0.05">
              </div>
              <div class="settings-row">
                <label for="scale-input">Render Scale</label>
                <input type="number" id="scale-input" class="input" style="width: 80px" value="1.0" min="0.5" max="3.0"
                  step="0.5">
              </div>
              <div class="settings-row">
                <label for="next-preview-checkbox">Show Next Preview</label>
                <input type="checkbox" id="next-preview-checkbox" checked>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Presenter Screen -->
  <div id="presenter-screen" class="presenter-screen">
    <!-- Top Bar -->
    <div class="top-bar">
      <div class="top-bar-left">
        <!-- Home Button -->
        <button id="home-btn" class="btn btn-icon" title="Back to Home">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M3 9l9-7 9 7v11a2 2 0 01-2 2H5a2 2 0 01-2-2z" />
            <polyline points="9 22 9 12 15 12 15 22" />
          </svg>
        </button>
        <!-- Page Navigation -->
        <div class="page-info">
          <span id="page-current" class="page-current">1</span>
          <span class="page-total">/ <span id="page-total">1</span></span>
        </div>
        <div class="page-nav">
          <button id="prev-btn" class="btn btn-icon" title="Previous (â†)">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M15 18l-6-6 6-6" />
            </svg>
          </button>
          <button id="next-btn" class="btn btn-icon" title="Next (â†’, Space)">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M9 18l6-6-6-6" />
            </svg>
          </button>
        </div>
        <div class="page-jump">
          <input type="number" id="jump-input" class="input" placeholder="#" min="1" title="Go to page">
        </div>
      </div>

      <div class="top-bar-center">
        <!-- Timer (centered) -->
        <div class="timer-section">
          <svg class="time-icon" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor"
            stroke-width="2">
            <circle cx="12" cy="13" r="8" />
            <path d="M12 9v4l2 2" />
            <path d="M5 3l2 2" />
            <path d="M19 3l-2 2" />
            <path d="M12 5V3" />
          </svg>
          <span id="timer-display" class="timer-value">00:00:00</span>
          <div class="timer-controls">
            <button id="timer-start-btn" class="btn btn-sm">Start</button>
            <button id="timer-reset-btn" class="btn btn-sm">Reset</button>
          </div>
        </div>
      </div>

      <div class="top-bar-right">
        <!-- Clock -->
        <div class="clock">
          <svg class="time-icon" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor"
            stroke-width="2">
            <circle cx="12" cy="12" r="10" />
            <path d="M12 6v6l4 2" />
          </svg>
          <span id="clock-display" class="clock-value">00:00:00</span>
        </div>
      </div>
    </div>

    <!-- Main Content -->
    <div class="presenter-main">
      <!-- Notes Panel (Left) -->
      <div class="notes-panel">
        <div class="notes-header">
          <h3>Notes</h3>
        </div>
        <div class="notes-canvas-wrapper">
          <canvas id="notes-canvas"></canvas>
        </div>
      </div>

      <!-- Preview Panel (Right) -->
      <div class="preview-panel">
        <div class="preview-section">
          <h4>Current Slide</h4>
          <div class="preview-canvas-wrapper">
            <canvas id="current-preview"></canvas>
          </div>
        </div>
        <div id="next-preview-section" class="preview-section">
          <h4>Next Slide</h4>
          <div class="preview-canvas-wrapper">
            <canvas id="next-preview"></canvas>
          </div>
        </div>
      </div>
    </div>

    <!-- Bottom Bar -->
    <div class="bottom-bar">
      <div class="bottom-bar-left">
        <div class="connection-status">
          <span id="connection-status" class="status-badge disconnected">Not connected</span>
        </div>
      </div>
      <div class="bottom-bar-right">
        <button id="open-audience-btn" class="btn">
          <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <rect x="3" y="3" width="18" height="18" rx="2" />
            <path d="M9 3v18" />
          </svg>
          Open Audience
        </button>
        <button id="fullscreen-btn" class="btn" title="Fullscreen (F)">
          <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M8 3H5a2 2 0 00-2 2v3m18 0V5a2 2 0 00-2-2h-3m0 18h3a2 2 0 002-2v-3M3 16v3a2 2 0 002 2h3" />
          </svg>
          Fullscreen
        </button>
      </div>
    </div>
  </div>

  <!-- Loading Overlay -->
  <div id="loading-overlay" class="loading-overlay hidden">
    <div class="loading-spinner"></div>
    <div class="loading-text">Loading...</div>
  </div>

  <!-- Toast -->
  <div id="toast" class="toast"></div>

  <!-- Main Script -->
  <script type="module" src="js/app.js"></script>
</body>

</html>